<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Contributing · MicroMagnetic.jl</title><meta name="title" content="Contributing · MicroMagnetic.jl"/><meta property="og:title" content="Contributing · MicroMagnetic.jl"/><meta property="twitter:title" content="Contributing · MicroMagnetic.jl"/><meta name="description" content="Documentation for MicroMagnetic.jl."/><meta property="og:description" content="Documentation for MicroMagnetic.jl."/><meta property="twitter:description" content="Documentation for MicroMagnetic.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><script src="../assets/init.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MicroMagnetic.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../basics/">Basics</a></li><li><a class="tocitem" href="../units/">Units</a></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Micromagnetics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/micromagnetics/nanobar/">Nanobar</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/vortex/">Magnetic vortex</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std4_sim_with/">Standard Problem 4 (sim_with)</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std4/">Standard Problem 4</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std5_sim_with/">Standard Problem 5 (sim_with)</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std5/">Standard Problem 5</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/skyrmion_stt/">Skyrmion dynamics under spin transfer torques</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/stoner_wohlfarth/">Stoner–Wohlfarth model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Atomistic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/atomistic/skyrmion/">Magnetic skyrmion</a></li><li><a class="tocitem" href="../tutorials/atomistic/skyrmion_lattice/">Skyrmion lattice</a></li><li><a class="tocitem" href="../tutorials/atomistic/skyrmion_afm/">Antiferromagnetic skyrmion</a></li><li><a class="tocitem" href="../tutorials/atomistic/sllg/">Stochastic LLG</a></li><li><a class="tocitem" href="../tutorials/atomistic/phase_diagram/">Phase diagram</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Monte carlo</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/monte_carlo/M_T_curve/">M-T curve using Monte Carlo</a></li><li><a class="tocitem" href="../tutorials/monte_carlo/skyrmion/">Skyrmion Phase using Monte Carlo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Neb</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/neb/neb_skx/">Skyrmion collapse using NEB</a></li></ul></li></ul></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../api/">API for users</a></li><li><a class="tocitem" href="../api_dev/">API for developers</a></li><li class="is-active"><a class="tocitem" href>Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Contributing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Contributing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MagneticSimulation/MicroMagnetic.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MagneticSimulation/MicroMagnetic.jl/blob/master/docs/src/contrib.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h1><h3 id="Step-by-Step-Guide"><a class="docs-heading-anchor" href="#Step-by-Step-Guide">Step-by-Step Guide</a><a id="Step-by-Step-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Step-by-Step-Guide" title="Permalink"></a></h3><h4 id="1.-**Fork-the-Repository**"><a class="docs-heading-anchor" href="#1.-**Fork-the-Repository**">1. <strong>Fork the Repository</strong></a><a id="1.-**Fork-the-Repository**-1"></a><a class="docs-heading-anchor-permalink" href="#1.-**Fork-the-Repository**" title="Permalink"></a></h4><p>Forking creates a personal copy of the MicroMagnetic.jl repository under your GitHub account.</p><ul><li>Go to the <strong>MicroMagnetic.jl</strong> repository: <a href="https://github.com/magneticsimulation/MicroMagnetic.jl">MicroMagnetic.jl</a>.</li><li>In the top-right corner, click the <strong>Fork</strong> button to create a copy of the repository in your own GitHub account.</li></ul><h4 id="2.-**Clone-Your-Fork**"><a class="docs-heading-anchor" href="#2.-**Clone-Your-Fork**">2. <strong>Clone Your Fork</strong></a><a id="2.-**Clone-Your-Fork**-1"></a><a class="docs-heading-anchor-permalink" href="#2.-**Clone-Your-Fork**" title="Permalink"></a></h4><p>After forking the repository, you need to clone your fork to your local machine to start working on it.</p><ul><li>Open your terminal (or Git Bash on Windows).</li><li>Clone the repository using the following command (replace <code>yourusername</code> with your GitHub username):<pre><code class="language-bash hljs">git clone https://github.com/yourusername/MicroMagnetic.jl
cd MicroMagnetic.jl</code></pre></li></ul><h4 id="3.-**(Optional)-Set-the-Original-Repository-as-Upstream**"><a class="docs-heading-anchor" href="#3.-**(Optional)-Set-the-Original-Repository-as-Upstream**">3. <strong>(Optional) Set the Original Repository as Upstream</strong></a><a id="3.-**(Optional)-Set-the-Original-Repository-as-Upstream**-1"></a><a class="docs-heading-anchor-permalink" href="#3.-**(Optional)-Set-the-Original-Repository-as-Upstream**" title="Permalink"></a></h4><p>To keep your fork in sync with the original repository, you can add the original <code>MicroMagnetic.jl</code> repository as a remote named <code>upstream</code>. This step is optional, but it helps you easily pull in updates from the main repository.</p><ul><li>Run the following commands to set it up:<pre><code class="language-bash hljs">git remote add upstream https://github.com/magneticsimulation/MicroMagnetic.jl
git fetch upstream</code></pre></li></ul><p>If you don&#39;t set up <code>upstream</code>, you can still contribute, but you’ll need to manually manage any updates from the original repository.</p><h4 id="4.-**Create-a-New-Branch**"><a class="docs-heading-anchor" href="#4.-**Create-a-New-Branch**">4. <strong>Create a New Branch</strong></a><a id="4.-**Create-a-New-Branch**-1"></a><a class="docs-heading-anchor-permalink" href="#4.-**Create-a-New-Branch**" title="Permalink"></a></h4><p>Before making any changes, create a new branch to isolate your modifications from the main branch. It&#39;s good practice to create descriptive branch names, like <code>fix-simulation-bug</code> or <code>add-feature-x</code>.</p><ul><li>Create and switch to a new branch:<pre><code class="language-bash hljs">git checkout -b my-new-feature</code></pre></li></ul><h4 id="5.-**Activate-Local-Development-in-Julia**"><a class="docs-heading-anchor" href="#5.-**Activate-Local-Development-in-Julia**">5. <strong>Activate Local Development in Julia</strong></a><a id="5.-**Activate-Local-Development-in-Julia**-1"></a><a class="docs-heading-anchor-permalink" href="#5.-**Activate-Local-Development-in-Julia**" title="Permalink"></a></h4><p>To ensure that Julia uses your local version of the package rather than the registered one, activate development mode in Julia. Assuming you have cloned the repository to <code>/path/to/MicroMagnetic.jl</code>, use the following command:</p><pre><code class="language-julia hljs">  using Pkg
  Pkg.develop(path=&quot;/path/to/MicroMagnetic.jl&quot;)</code></pre><p>This allows you to work on the local version of the package.</p><h4 id="6.-**Make-Your-Changes**"><a class="docs-heading-anchor" href="#6.-**Make-Your-Changes**">6. <strong>Make Your Changes</strong></a><a id="6.-**Make-Your-Changes**-1"></a><a class="docs-heading-anchor-permalink" href="#6.-**Make-Your-Changes**" title="Permalink"></a></h4><p>Now that you are in your new branch, you can start making changes to the code. For example, you can add new functionality, fix bugs, or update documentation.</p><ul><li>Use your favorite text editor or IDE to modify the source code in the <strong>MicroMagnetic.jl</strong> repository.</li></ul><h4 id="7.-**Test-Your-Changes**"><a class="docs-heading-anchor" href="#7.-**Test-Your-Changes**">7. <strong>Test Your Changes</strong></a><a id="7.-**Test-Your-Changes**-1"></a><a class="docs-heading-anchor-permalink" href="#7.-**Test-Your-Changes**" title="Permalink"></a></h4><p>Before pushing your changes, ensure they work correctly by running tests. The tests are usually located in the <code>test</code> folder.</p><ul><li>To run tests:<pre><code class="language-bash hljs">julia --project test/runtests.jl</code></pre></li></ul><p>Make sure all tests pass before proceeding. If any tests fail, debug and fix your code.</p><h4 id="8.-**Commit-Your-Changes**"><a class="docs-heading-anchor" href="#8.-**Commit-Your-Changes**">8. <strong>Commit Your Changes</strong></a><a id="8.-**Commit-Your-Changes**-1"></a><a class="docs-heading-anchor-permalink" href="#8.-**Commit-Your-Changes**" title="Permalink"></a></h4><p>Once you&#39;re happy with the changes, you need to commit them. Make sure to write a clear and concise commit message describing what you’ve done.</p><ul><li>Stage your changes:<pre><code class="language-bash hljs">git add .</code></pre></li><li>Commit with a message:<pre><code class="language-bash hljs">git commit -m &quot;Add feature X to improve simulation accuracy&quot;</code></pre></li></ul><h4 id="9.-**Push-Your-Changes-to-Your-Fork**"><a class="docs-heading-anchor" href="#9.-**Push-Your-Changes-to-Your-Fork**">9. <strong>Push Your Changes to Your Fork</strong></a><a id="9.-**Push-Your-Changes-to-Your-Fork**-1"></a><a class="docs-heading-anchor-permalink" href="#9.-**Push-Your-Changes-to-Your-Fork**" title="Permalink"></a></h4><p>Now that you’ve committed your changes locally, push them to your forked repository on GitHub.</p><ul><li>Push your branch:<pre><code class="language-bash hljs">git push origin my-new-feature</code></pre></li></ul><h4 id="10.-**Open-a-Pull-Request**"><a class="docs-heading-anchor" href="#10.-**Open-a-Pull-Request**">10. <strong>Open a Pull Request</strong></a><a id="10.-**Open-a-Pull-Request**-1"></a><a class="docs-heading-anchor-permalink" href="#10.-**Open-a-Pull-Request**" title="Permalink"></a></h4><p>Once your changes are pushed to your fork on GitHub, you’re ready to open a pull request (PR) to merge your changes back into the main repository.</p><ul><li>Go to your forked repository on GitHub.</li><li>You’ll see a button prompting you to open a pull request. Click on it.</li><li>In the pull request, provide a detailed description of the changes you made, why they are needed, and any relevant information.</li><li>Submit the pull request.</li></ul><h4 id="11.-**(Optional)-Keep-Your-Fork-Up-to-Date**"><a class="docs-heading-anchor" href="#11.-**(Optional)-Keep-Your-Fork-Up-to-Date**">11. <strong>(Optional) Keep Your Fork Up-to-Date</strong></a><a id="11.-**(Optional)-Keep-Your-Fork-Up-to-Date**-1"></a><a class="docs-heading-anchor-permalink" href="#11.-**(Optional)-Keep-Your-Fork-Up-to-Date**" title="Permalink"></a></h4><p>As the original <code>MicroMagnetic.jl</code> repository evolves, you’ll want to keep your fork in sync with the latest changes. If you followed step 3 to set <code>upstream</code>, you can do this easily.</p><ul><li>Fetch the latest updates from the original repository:<pre><code class="language-bash hljs">git fetch upstream</code></pre></li><li>Merge the changes into your local branch:<pre><code class="language-bash hljs">git merge upstream/main</code></pre></li></ul><h3 id="An-Example:-Adding-Hexagonal-Anisotropy"><a class="docs-heading-anchor" href="#An-Example:-Adding-Hexagonal-Anisotropy">An Example: Adding Hexagonal Anisotropy</a><a id="An-Example:-Adding-Hexagonal-Anisotropy-1"></a><a class="docs-heading-anchor-permalink" href="#An-Example:-Adding-Hexagonal-Anisotropy" title="Permalink"></a></h3><p>All changes can be found at <a href="https://github.com/MagneticSimulation/MicroMagnetic.jl/commit/6a9d7ec7f01cacfaa7a908dc286f58a5bcae910b">this commit</a>.</p><h4 id="1.-**Find-the-Energy-Expression**"><a class="docs-heading-anchor" href="#1.-**Find-the-Energy-Expression**">1. <strong>Find the Energy Expression</strong></a><a id="1.-**Find-the-Energy-Expression**-1"></a><a class="docs-heading-anchor-permalink" href="#1.-**Find-the-Energy-Expression**" title="Permalink"></a></h4><p>The energy density of hexagonal anisotropy is expressed as:</p><p class="math-container">\[E = K_1 \sin^2 \theta + K_2 \sin^4 \theta + K_3 \sin^6 \theta \cos 6\phi\]</p><p>Here, <span>$\theta$</span> is the angle between the magnetization vector <span>$\mathbf{m}$</span> and the <span>$c$</span>-axis (<span>$z$</span>-axis). <span>$\phi$</span> is the angle of the projection of <span>$\mathbf{m}$</span> on the hexagonal plane, measured with respect to the <span>$x$</span>-axis.</p><h4 id="2.-**Compute-the-Effective-Field**"><a class="docs-heading-anchor" href="#2.-**Compute-the-Effective-Field**">2. <strong>Compute the Effective Field</strong></a><a id="2.-**Compute-the-Effective-Field**-1"></a><a class="docs-heading-anchor-permalink" href="#2.-**Compute-the-Effective-Field**" title="Permalink"></a></h4><p>Using the identity <span>$\cos 6x = -\sin^6 x + 15 \cos^2 x \sin^4 x - 15 \cos^4 x \sin^2 x + \cos^6 x$</span>, the energy density can be rewritten in terms of <span>$m_x$</span>, <span>$m_y$</span>, and <span>$m_z$</span> as:</p><p class="math-container">\[E = K_1 (1 - m_z^2) + K_2 (1 - m_z^2)^2 + K_3 \left( m_x^6 - 15m_x^4 m_y^2 + 15m_x^2 m_y^4 - m_y^6 \right)\]</p><p>The corresponding effective field is:</p><p class="math-container">\[\mathbf{H}_\mathrm{eff} = -\frac{6K_3}{\mu_0 M_s} \left( m_x^5 - 10m_x^3m_y^2 + 5m_xm_y^4 \right) \mathbf{e}_x 
 -\frac{6K_3}{\mu_0 M_s} \left( -6m_x^4m_y + 10m_x^2m_y^3 - m_y^5 \right) \mathbf{e}_y 
+ \frac{2m_z}{\mu_0 M_s} \left[ K_1 + 2K_2(1 - m_z^2) \right] \mathbf{e}_z\]</p><h4 id="3.-**Define-the-Struct-in-src/head.jl**"><a class="docs-heading-anchor" href="#3.-**Define-the-Struct-in-src/head.jl**">3. <strong>Define the Struct in <code>src/head.jl</code></strong></a><a id="3.-**Define-the-Struct-in-src/head.jl**-1"></a><a class="docs-heading-anchor-permalink" href="#3.-**Define-the-Struct-in-src/head.jl**" title="Permalink"></a></h4><pre><code class="language-julia hljs">mutable struct HexagonalAnisotropy{T&lt;:AbstractFloat} &lt;: MicroEnergy
    K1::T
    K2::T 
    K3::T
    field::AbstractArray{T,1}
    energy::AbstractArray{T,1}
    name::String
end</code></pre><h4 id="4.-**Add-the-Interface-in-src/micro/add_field.jl**"><a class="docs-heading-anchor" href="#4.-**Add-the-Interface-in-src/micro/add_field.jl**">4. <strong>Add the Interface in <code>src/micro/add_field.jl</code></strong></a><a id="4.-**Add-the-Interface-in-src/micro/add_field.jl**-1"></a><a class="docs-heading-anchor-permalink" href="#4.-**Add-the-Interface-in-src/micro/add_field.jl**" title="Permalink"></a></h4><p>Add the following interface and export it. Including documentation is also recommended.</p><pre><code class="language-julia hljs">function add_hex_anis(sim::AbstractSim, K1=0, K2=0, K3=0, name=&quot;hex&quot;)
    n_total = sim.n_total
    field = create_zeros(3 * n_total)
    energy = create_zeros(n_total)

    T = Float[]
    anis = HexagonalAnisotropy(T(K1), T(K2), T(K3), field, energy, name)
    push!(sim.interactions, anis)

    if sim.save_data
        id = length(sim.interactions)
        push!(sim.saver.items,
              SaverItem(string(&quot;E_&quot;, name), &quot;&lt;J&gt;&quot;,
                        o::AbstractSim -&gt; sum(o.interactions[id].energy)))
    end
    return anis
end</code></pre><h4 id="5.-**Implement-the-Kernel-in-src/micro/kernels.jl**"><a class="docs-heading-anchor" href="#5.-**Implement-the-Kernel-in-src/micro/kernels.jl**">5. <strong>Implement the Kernel in <code>src/micro/kernels.jl</code></strong></a><a id="5.-**Implement-the-Kernel-in-src/micro/kernels.jl**-1"></a><a class="docs-heading-anchor-permalink" href="#5.-**Implement-the-Kernel-in-src/micro/kernels.jl**" title="Permalink"></a></h4><pre><code class="language-julia hljs">@kernel function hexagonal_anisotropy_kernel!(@Const(m), h, energy, K1::T, K2::T, K3::T, 
                                            @Const(mu0_Ms), volume::T) where {T&lt;:AbstractFloat}
    id = @index(Global)
    j = 3 * (id - 1)

    @inbounds Ms_local = mu0_Ms[id]

    if Ms_local == 0.0
        @inbounds energy[id] = 0
        @inbounds h[j + 1] = 0
        @inbounds h[j + 2] = 0
        @inbounds h[j + 3] = 0
    else
        Ms_inv::T = 1.0 / Ms_local
        @inbounds mx = m[j + 1]
        @inbounds my = m[j + 2]
        @inbounds mz = m[j + 3]
        @inbounds h[j + 1] = -6*K3*Ms_inv*(mx^5-10*mx^3*my^2+5*mx*my^4)
        @inbounds h[j + 2] = -6*K3*Ms_inv*(-5*mx^4*my+10*mx^2*my^3-my^5)
        @inbounds h[j + 3] = 2*mz*Ms_inv*(K1 + 2*K2*(1-mz*mz))
        @inbounds energy[id] = (K1*(1-mz*mz) + K2*(1-mz*mz)^2 + K3*(mx^6-15*mx^4*my^2+15*mx^2*my^4-my^6)) * volume
    end
end</code></pre><h4 id="6.-**Implement-effective_field-Function-in-src/micro/field.jl**"><a class="docs-heading-anchor" href="#6.-**Implement-effective_field-Function-in-src/micro/field.jl**">6. <strong>Implement <code>effective_field</code> Function in <code>src/micro/field.jl</code></strong></a><a id="6.-**Implement-effective_field-Function-in-src/micro/field.jl**-1"></a><a class="docs-heading-anchor-permalink" href="#6.-**Implement-effective_field-Function-in-src/micro/field.jl**" title="Permalink"></a></h4><pre><code class="language-julia hljs">function effective_field(anis::HexagonalAnisotropy, sim::MicroSim, spin::AbstractArray{T,1},
                         t::Float64) where {T&lt;:AbstractFloat}
    N = sim.n_total
    volume = T(sim.mesh.volume)

    hexagonal_anisotropy_kernel!(default_backend[])(spin, anis.field, anis.energy, anis.K1, 
                                            anis.K2, anis.K3, sim.mu0_Ms, volume; ndrange=N)

    return nothing
end</code></pre><h4 id="7.-**Add-Unit-Tests-(test/test_anis.jl)**"><a class="docs-heading-anchor" href="#7.-**Add-Unit-Tests-(test/test_anis.jl)**">7. <strong>Add Unit Tests (<code>test/test_anis.jl</code>)</strong></a><a id="7.-**Add-Unit-Tests-(test/test_anis.jl)**-1"></a><a class="docs-heading-anchor-permalink" href="#7.-**Add-Unit-Tests-(test/test_anis.jl)**" title="Permalink"></a></h4><p>In the <code>test_hex_anis</code> function, compute the effective field for a given magnetization and compare it with results obtained using automatic differentiation.</p><pre><code class="language-julia hljs">function hexagonal_energy(m, K1, K2, K3)
    mx, my, mz = m[1], m[2], m[3]
    return K1*(1-mz*mz) + K2*(1-mz*mz)^2 + K3*(mx^6-15*mx^4*my^2+15*mx^2*my^4-my^6)
end

function test_hex_anis()
    mesh = FDMesh(; nx=10, ny=1, nz=1)

    sim = Sim(mesh)
    Ms = 8.6e5
    set_Ms(sim, Ms)
    m0 = (0.7, -0.4, 1.2)
    init_m0(sim, m0; norm=false)

    K1, K2, K3 = 1.23e2, 3.7e3, 6.9e2
    anis = add_hex_anis(sim, K1=K1, K2=K2, K3=K3)

    MicroMagnetic.effective_field(sim, sim.spin, 0.0)

    field = Array(anis.field)
    energy = Array(anis.energy)

    gd = Enzyme.gradient(Forward, hexagonal_energy, m0, Const(K1), Const(K2), Const(K3))
    expected = - collect(gd[1]) ./ (MicroMagnetic.mu_0*Ms)

    @test isapprox(field[1:3], expected)
    @test isapprox(energy[1]*1e27, hexagonal_energy(m0, K1, K2, K3), rtol=1e-5)
end</code></pre><h4 id="8.-**Add-Documentation**"><a class="docs-heading-anchor" href="#8.-**Add-Documentation**">8. <strong>Add Documentation</strong></a><a id="8.-**Add-Documentation**-1"></a><a class="docs-heading-anchor-permalink" href="#8.-**Add-Documentation**" title="Permalink"></a></h4><p>It&#39;s recommended to document the implementation for better clarity and user understanding.</p><h3 id="Summary-of-Key-Commands"><a class="docs-heading-anchor" href="#Summary-of-Key-Commands">Summary of Key Commands</a><a id="Summary-of-Key-Commands-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-of-Key-Commands" title="Permalink"></a></h3><p>Here’s a quick reference for the key Git commands used in this guide:</p><ul><li>Fork: (via GitHub UI)</li><li>Clone: <code>git clone https://github.com/yourusername/MicroMagnetic.jl</code></li><li>(Optional) Set Upstream: <code>git remote add upstream https://github.com/magneticsimulation/MicroMagnetic.jl</code></li><li>New Branch: <code>git checkout -b my-new-feature</code></li><li>Add Changes: <code>git add .</code></li><li>Commit: <code>git commit -m &quot;message&quot;</code></li><li>Push: <code>git push origin my-new-feature</code></li><li>(Optional) Fetch Updates: <code>git fetch upstream</code></li><li>(Optional) Merge Updates: <code>git merge upstream/main</code></li><li>Activate Local Development: <code>Pkg.develop(path=&quot;/path/to/MicroMagnetic.jl&quot;)</code></li></ul><p>Feel free to explore, experiment, and contribute to making <strong>MicroMagnetic.jl</strong> even better!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api_dev/">« API for developers</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Sunday 16 February 2025 04:33">Sunday 16 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
