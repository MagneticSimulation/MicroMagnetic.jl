<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MicroMagnetic.jl Visualization</title>
    
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.163.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.163.0/examples/jsm/",
                "lil-gui": "https://unpkg.com/lil-gui@0.19.2/dist/lil-gui.esm.js"
            }
        }
    </script>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="src/styles/cell.css">
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="src/styles/panel.css">
    
    <!-- JavaScript Files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/julia/julia.min.js"></script>
</head>
<body>
    <div class="main-container">
        <!-- Left section: Three.js visualization -->
        <div class="visualization-section">
            <div id="visualization-container"></div>
            <!-- Lil-GUI Controls Panel - Floating on top of visualization -->
            <div id="lilgui-panel" class="lilgui-panel"></div>
        </div>
        
        <!-- Right section: Controls panel -->
        <div class="controls-section">
            <!-- Main Controls Panel -->
            <div id="controls-panel">             
               <div style="font-size: 20px; font-weight: 600; color: #333333; margin-bottom: 20px;"> 
                MicroMagnetic.jl 
               </div>
                <div class="control-section">
                    <div style="display: flex; align-items: center; justify-content: space-between; gap: 10px;">
                        <div style="margin: 0; font-weight: 500; color: #333333;">Server:</div>
                        <div style="display: flex; align-items: center; gap: 10px; flex: 1;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <div id="ws-status-indicator" class="status-indicator disconnected"></div>
                                <span id="ws-status-text">Disconnected</span>
                            </div>
                            <button id="ws-connect-btn" class="connect-btn disconnected">Connect</button>
                        </div>
                    </div>
                </div>
                
                <!-- Simulation Type and Task Type Section -->
                <div class="control-section">
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <select id="simulation-type" style="padding: 6px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 14px; background-color: #ffffff; flex: 1; min-width: 120px;">
                            <option value="fd" selected>Finite Difference (FD)</option>
                            <option value="fe">Finite Element (FE)</option>
                            <option value="atomistic">Atomistic</option>
                        </select>
                        
                        <div style="margin: 0; font-weight: 500; color: #333333; width: 80px;">Sim Type:</div>
                        <select id="task-type" style="padding: 6px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 14px; background-color: #ffffff; flex: 1; min-width: 120px;">
                            <option value="demo">Demo</option>
                            <option value="relax" selected>Relax</option>
                            <option value="relax_dyn">Dynamics</option>
                            <option value="hysteresis">Hysteresis</option>
                        </select>
                    </div>
                </div>
                
                <!-- Example Selection Section -->
                <div class="control-section">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="margin: 0; font-weight: 500; color: #333333; width: 100px;">Example:</div>
                        <select id="example-selector" style="flex: 1; padding: 6px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 14px; background-color: #ffffff;">
                            <option value="" selected>-- Select Example --</option>
                            <option value="vortex">Vortex</option>
                            <option value="std4">Standard 4</option>
                            <option value="std5">Standard 5</option>
                        </select>
                    </div>
                </div>
                
                <!-- Cell Section -->
                <div class="control-section">
                    <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                        <button id="add-cell-btn">Add Cell</button>
                        <select id="cell-selector" style="flex: 1; padding: 6px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 14px; background-color: #ffffff;">
                            <option value="">-- Select Cell --</option>
                        </select>
                        <button id="show-panel-btn" style="padding: 6px 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 14px; background-color: #ffffff; cursor: pointer;">
                            Show Panel
                        </button>
                    </div>
                    <div id="cells-container"></div>
                </div>
                
                <!-- Execution Panel Section (Combined Status Bar and Output) -->
                <div class="control-section">
                    <div style="font-weight: 500; color: #333333; margin-bottom: 10px;">Execution Panel</div>
                    <div id="execution-panel" class="execution-panel">
                        <div class="execution-status">
                            <span class="status-label">Status:</span>
                            <span id="execution-status" class="status-value">Not Run</span>
                        </div>
                        <div id="unified-output" class="unified-output">
                            <div class="output-placeholder">Execute code to see output here</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
      
    <!-- Import the bundle.js file (built by Rollup) -->
    <script type="module" src="src/index.js"></script>
</body>
</html>